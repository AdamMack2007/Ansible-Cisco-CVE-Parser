{
  "type": "page",
  "title": "Network CVE Report - {{ current_date }}",
  "space": { "key": "{{ confluence_space }}" },
  "ancestors": [{"id":{{ confluence_parent_page_id[0] }}}],
  "body": {
    "storage": {
      "representation": "storage",
      "value": """
      <p style="font-size:26px"><u>Device OS:</u></p>
      <p><ac:structured-macro ac:name="toc\"/></p>
      {% for platform, os in cve_data.items() %}
      <h1><u>{{ platform | upper }}</u></h1>
      {% for version, cves in os.items() %}
      <h2>Version: {{ version }}</h2>
      <h3>Devices Affected</h3>
      {% for device in cves['hosts'] %}
      <ul>
        <li>{{ device }}</li>
      </ul>
      {% endfor %}
      <table>
      <thead>
        <tr>
          <th style="text-align:center">CVE ID</th>
          <th style="text-align:center">Severity</th>
          <th style="text-align:center">Summary</th>
          <th style="text-align:center">Fixed Versions</th>
          <th style="text-align:center">Remediation</th>
        </tr>
      </thead>
      <tbody>
      {% for cve in cves.data|sort(attribute='severity') %}
        <tr>
          <td style="text-align:center"><a href="{{ cve.url }}">{{ cve.cves|join(', ') }}</a></td>
          <td style="text-align:center">{{ cve.severity }}</td>
          <td style="text-align:center">{{ cve.title }}</td>
          <td style="text-align:center">{% if cve.fixed_version is string %}{{ cve.fixed_version|default() }}{% else %}{{ cve.fixed_version|join(',')|default() }}{% endif %}</td>
          <td style="text-align:center"></td>
        </tr>
      {% endfor %}
</tbody>
</table>{% endfor %}{% endfor %}"""
    }
  }
}